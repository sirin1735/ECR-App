{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2 class="mb-4">Add Product</h2>

    <form method="post" class="border p-4 bg-white rounded shadow-sm">
        <div class="mb-3">
            <label class="form-label">Product Name</label>
            <input type="text" name="name" class="form-control" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Sale Price</label>
            <input type="number" name="price" step="0.01" class="form-control" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Purchase Price</label>
            <input type="number" name="purchase_price" step="0.01" class="form-control" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Company</label>
            <input type="text" name="company" class="form-control" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Image URL or Path </label>
            <input type="text" name="image_url" class="form-control" id="image_url" required>
            <div class="mt-2">
                <img id="preview" src="https://via.placeholder.com/200x150" class="img-thumbnail" width="200">
            </div>
        </div>

        <div class="d-grid">
            <button type="submit" class="btn btn-success">➕ Add Product</button>
        </div>
    </form>
</div>

<!-- ✅ JavaScript for live preview -->
<script>
    const input = document.getElementById("image_url");
    const preview = document.getElementById("preview");

    input.addEventListener("input", function () {
        let path = input.value.trim();

        if (!path) {
            preview.src = "https://via.placeholder.com/200x150";
            return;
        }

        // If path doesn't start with "http", assume it's a local static image
        if (!path.startsWith("http")) {
            path = "/static/" + path;
        }

        preview.src = path;
    });
</script>
{% endblock %}